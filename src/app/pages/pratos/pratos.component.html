<container-central [(drawer)]="editarForm" [loading]="loading()">
  <div drawer class="ovh hf">
    @if (editarForm) {
      <app-pratos-form-component
        [(visible)]="editarForm"
        [data]="editarFormData()"
      />
    }
  </div>

  <div header>
    @if (!loading() && !tipoSelecao()) {
      <button
        mat-raised-button
        color="primary"
        style="margin-bottom: 10px"
        (click)="incluir()"
      >
        Novo
      </button>
    }
  </div>

  <div content>
    <mat-accordion>
      @for (grupo of data$ | async; track grupo._id) {
        <mat-expansion-panel [corBoarda]="grupo.cor">
          <mat-expansion-panel-header>
            <mat-panel-title>
              <div class="fx-row wf" style="margin-right: 10px">
                <div class="fx-flex fx-row">
                  @if (!tipoSelecao()) {
                    <app-grupo-principal-component
                      [principal]="grupo.principal"
                    />
                  }
                  <span style="font-weight: bold">{{ grupo.nome }}</span>
                </div>
              </div>
            </mat-panel-title>
            @if (grupo.observacao) {
              <mat-panel-description>
                <span class="lbl-observacao">{{ grupo.observacao }}</span>
              </mat-panel-description>
            }
          </mat-expansion-panel-header>

          <div class="comp-inner-grid" style="gap: 5px">
            @for (item of grupo.pratos; track item._id) {
              @if (!pratoStore.pedidoItemVinculado[item!._id!]) {
                <mat-card
                  (click)="incluirPratoPedido(item)"
                  [ngStyle]="{ cursor: tipoSelecao() ? 'pointer' : 'none' }"
                >
                  <mat-card-header>
                    <mat-card-title>{{ item.nome }}</mat-card-title>
                    <mat-card-subtitle>
                      {{ item.observacao }}
                    </mat-card-subtitle>
                  </mat-card-header>
                  <mat-card-content>
                    @if (
                      item.composicoes &&
                      item.composicoes.length > 0 &&
                      !tipoSelecao()
                    ) {
                      <div style="padding: 10px">
                        <mat-chip-set>
                          @for (composicao of item.composicoes; track $index) {
                            <mat-chip>{{ composicao }}</mat-chip>
                          }
                        </mat-chip-set>
                      </div>
                    }
                  </mat-card-content>
                  @if (!tipoSelecao()) {
                    <mat-card-actions>
                      <button mat-button (click)="editar(item)">
                        Editar <mat-icon>edit</mat-icon>
                      </button>
                      <button mat-button (click)="removerRegistro(item)">
                        Remover <mat-icon class="cred">delete</mat-icon>
                      </button>
                    </mat-card-actions>
                  }
                </mat-card>
              }
            }
          </div>
        </mat-expansion-panel>
      }
    </mat-accordion>
  </div>
</container-central>
